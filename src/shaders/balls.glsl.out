#define AN float
#define AW return
#define BV vec2
#define KP smoothstep
uniform AN f;uniform BV r;BV A(BV b,AN a){AW BV(b.x*cos(a)-b.y*sin(a),b.x*sin(a)+b.y*cos(a));}BV B(BV c,BV b,AN a){for(int d=0;d<14;d++){c=A(c,3.14*2./14.);c.x=abs(c.x);}c-=b;AW c;}AN C(BV a){AW pow(pow(a.x,2.)+pow(a.y,2.),.5);}vec3 D(AN b,AN a){AW sin(vec3(12.23,45.23,56.2)+a*3.)*.5+.5;}AN E(BV c,AN b,AN a){c=B(c,BV(.3+.2*sin(b),.4),2.+sin(b/3.));AN d=0.;for(AN f=0.;f<10.;f++){for(AN g=0.;g<10.;g++){BV e=BV(f+mod(g,2.)/2.-8.,(g-8.)*.707)/16.;AN h=sin(pow(f-8.,2.)+pow(g-8.,2.)+b+25.*C(c-e))*.05*a;if(C(c-e)<h){d+=1.;}else{d+=0.;}}}d-=1.1;d=mod(d,2.)-.95;AW d;}vec4 F(BV a,BV b){vec4 j;BV t=(a/b.xy)/BV(1.,16./9.);t-=BV(.5,9./16./2.);AN l=f/60.;AN f=dot(t,t);AN q=l/3.;AN n=0.;AN e=max(1.,min(8.,(l-8.)/2.));for(AN k=0.;k<1.;k+=1./3.){AN q=fract(k+q);AN u=mix(7.,.1,q);AN g=KP(0.,.3,q)*KP(1.,.7,q);n+=g*q*E(t*u/1.8,l+k,e);}vec3 d=D(l,C(t));AN m=E(t,l,1.);AN s=l-6.;AN o=KP(1.,0.,s)*m+KP(0.,1.,s)*n;AN c=max(0.,min(1.,(l-14.)/2.));vec3 k=d*(1.-c)+vec3(133./255.,243./255.,159./255.)*c;vec3 p=o*d;vec3 h=p*(1.-c)+vec3(133./255.,243./255.,159./255.)*c;j=vec4(h,1.);AW j;}void main(){BV a=gl_FragCoord.xy/r;gl_FragColor=F(gl_FragCoord.xy,r);}
